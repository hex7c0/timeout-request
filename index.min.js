"use strict";function wrapper(a,b){function c(a,b){return b.end(),a.socket.destroy()}var d;return d=b?a.header?function(b,c){var d=c.finished||c.socket&&c.socket.writable===!1;return d===!1?a.callback(b,c,a.data):null}:function(b,c){return a.callback(b,c,a.data)}:a.header?function(a,b){var d=b.finished||b.socket&&b.socket.writable===!1;return d===!1?c(a,b):null}:function(a,b){return c(a,b)},function(b,c,e){b.timeout=setTimeout(d.bind(this,b,c),a.milliseconds);var f=b.socket.destroy;b.socket.destroy=function(){clearTimeout(b.timeout),f.call(this)};var g=c.end;return c.end=function(a,c){clearTimeout(b.timeout),g.call(this,a,c)},e()}}function timeout(a){var b=a||Object.create(null),c={milliseconds:Number(b.milliseconds)||5e3,header:Boolean(b.header)};return b.callback&&"function"==typeof b.callback?(c.callback=b.callback,c.data=b.data,wrapper(c,!0)):wrapper(c,!1)}module.exports=timeout;
