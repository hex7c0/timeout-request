"use strict";function wrapper(a,b){var c;if(b)c=a.header?function(b,c){var d=c.finished===!0||void 0!==b.socket&&b.socket.writable===!1;return d===!1?a.callback(b,c,a.data):null}:function(b,c){return a.callback(b,c,a.data)};else{var d=function(a,b){return b.end(),a.socket.destroy()};c=a.header?function(a,b){var c=b.finished===!0||void 0!==a.socket&&a.socket.writable===!1;return c===!1?d(a,b):null}:function(a,b){return d(a,b)}}return function(b,d,e){b.timeout=setTimeout(c.bind(this,b,d),a.milliseconds);var f=b.socket.destroy;b.socket.destroy=function(){clearTimeout(b.timeout),f.call(this)};var g=d.end;return d.end=function(a,c){clearTimeout(b.timeout),g.call(this,a,c)},e()}}function timeout(a){var b=a||Object.create(null),c={milliseconds:Number(b.milliseconds)||5e3,header:Boolean(b.header)};return b.callback&&"function"==typeof b.callback?(c.callback=b.callback,c.data=b.data,wrapper(c,!0)):wrapper(c,!1)}module.exports=timeout;
